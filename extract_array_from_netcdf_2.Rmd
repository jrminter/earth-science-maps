---
title: "Extract Array from Netcdf"
author: "John Minter"
output:
  knitr:::html_vignette:
    css: inc/jm-gray-vignette.css
    number_sections: yes
    toc: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Objective

Test the approach from [Mark Payne](https://rpubs.com/markpayne/358146).

# Load Packages

Explicitly load all packages

```{r loadPackages}
library(sp)
library(raster)
library(ncdf4)
library(here)
```

# Setup a raster

Mark Payne explains:

> The raster package has three basic types of data structures:
>
> - a “raster” for two dimensional data (e.g. lat-lon data)
>
> - a “brick”, which is for three dimensional data (e.g. lon-lon-time)
>   where the data is in a single file
>
> - a “stack”, which is also three dimensional, but where the data is spread
>   across multiple files (e.g. where you have one NetCDF file per month)
>
> Raster can also support higher dimensional data, up to around four dimensions,
> and can interface to high dimensionality data by focussing on one aspect of it
> at a time.
>
> In this case we want a `raster`, which we create as follows:


```{r setupRaster}
fname <- paste0(here(), '/data/netcdf/19990908120000-CMC-L4_GHRSST-SSTfnd-CMC0.2deg-GLOB-v02.0-fv02.0.nc')

SST.r <- raster(fname)
arr <- as.matrix(SST.r)
dim(arr)
```

Let's see what this raster contains:

```{r showRasterContents}
SST.r
```

So from this we can see that we have a 0.2x0.2 degree resolution grid, that runs from -180 to +180 in the longtitudinal direction, from -90 to 90 in the latitudinal i.e. it’s global. We have have a look at the contents using plot

```{r plotRaster1}
plot(SST.r)
```

```{r plotRaster2}
plot(SST.r/10.0)
```